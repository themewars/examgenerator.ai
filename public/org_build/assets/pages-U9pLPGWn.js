document.addEventListener("DOMContentLoaded",function(){const d=document.querySelectorAll(".poll-form");d&&d.forEach(function(u){u.addEventListener("submit",function(p){document.querySelectorAll(".poll-option").forEach(function(b){b.disabled=!0})})});const r=document.getElementById("answers-container"),t=document.getElementById("questionForm");if(r&&t){let h=function(n){const o=document.getElementById("validation-error");o&&o.remove();const e=document.createElement("div");e.id="validation-error",e.style.color="#991b1b",e.style.backgroundColor="#fef2f2",e.className="p-3 ps-4 mb-1 text-start text-md rounded-lg",e.innerText=n,r.prepend(e),setTimeout(()=>{e.remove()},3e3)};var S=h;const u=r.dataset.isMultipleChoice=="1",p=parseInt(r.dataset.answerLimit||0,10),y=r.dataset.noSelectedErrorMessage||"Please select at least one answer before continuing.",b=r.dataset.limitErrorMessage||`You can only select up to ${p} options.`,k=t.dataset.isEnabledTimer=="1",I=parseInt(t.dataset.timeType,10),q=parseInt(t.dataset.countdown,10),x=document.getElementById("questionId").value||1,C=document.getElementById("quizUserId").value||1,m=I==1?`quiz_end_time_${C}_${x}`:`quiz_global_end_time_${C}`;let i=null;if(k){let o=function(){const s=Date.now(),c=Math.floor((i-s)/1e3);if(c<=0)n&&clearInterval(n),document.getElementById("time_expired").value=I,localStorage.removeItem(m),t.submit();else{const a=document.getElementById("time-remaining");a&&(a.textContent=e(c)),l(c,q)}},e=function(s){const c=Math.floor(s/60),a=s%60;return`${c.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`},l=function(s,c){const a=Math.max(s/c*100,0),v=document.getElementById("timer-progress-bar");if(v){v.style.width=`${a}%`;let E="linear-gradient(to right, #f3c6fd, #ac4be0, #651fae)";a<30?E="linear-gradient(to right, #ff8a8a, #d94d4d)":a<60&&(E="linear-gradient(to right, #ffd480, #ffb347)"),v.style.backgroundImage=E}};var B=o,_=e,L=l;let n;i=localStorage.getItem(m),i?i=parseInt(i):(i=Date.now()+q*1e3,localStorage.setItem(m,i)),o(),n=setInterval(o,1e3)}const f=t.querySelectorAll("input[type='checkbox']");let g=[];u&&f.length>0&&f.forEach(n=>{n.addEventListener("change",function(){const o=t.querySelectorAll("input[type='checkbox']:checked").length;if(this.checked){if(g.push(this),o>p){const e=g.shift();e&&(e.checked=!1),h(b)}}else g=g.filter(e=>e!==this)})}),t.addEventListener("submit",function(n){const o=Date.now();if(k&&i&&Math.floor((i-o)/1e3)<=0){timerInterval&&clearInterval(timerInterval),document.getElementById("time_expired").value=I,localStorage.removeItem(m);return}if(u&&f.length>0){if(!Array.from(f).some(s=>s.checked)){n.preventDefault(),h(y);return}}else if(!t.querySelector('input[name="answer_id"]:checked')){n.preventDefault(),h(y);return}const e=t.querySelector(".submitAnswerButton");e&&(e.disabled=!0)})}});const w=document.getElementById("answers-container");w&&w.addEventListener("click",d=>{const r=d.target.closest('input[type="radio"]');if(r){w.querySelectorAll("label").forEach(S=>{S.style.backgroundColor="#f3f4f6"});const t=r.closest("label");t&&(t.style.backgroundColor="#c66bff3b")}});
